# ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ êµ¬í˜„ ê°€ì´ë“œ (Flutter Web) - ê°œì„ íŒ

## ğŸ“‹ ê°œìš”

ì¹´ì¹´ì˜¤ ê³µì‹ **Flutter SDK**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ í™˜ê²½ì—ì„œ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ êµ¬í˜„í•©ë‹ˆë‹¤.  
ê³µì‹ SDKë¥¼ ì‚¬ìš©í•˜ë©´ JavaScript Interop ì—†ì´ ì•ˆì •ì ì´ê³  ì‰½ê²Œ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ†š êµ¬í˜„ ë°©ì‹ ë¹„êµ

| êµ¬ë¶„ | JavaScript SDK | **Flutter SDK (ê¶Œì¥)** |
|------|----------------|----------------------|
| ì•ˆì •ì„± | âš ï¸ Interop í•„ìš” | âœ… ê³µì‹ ì§€ì› |
| ìœ ì§€ë³´ìˆ˜ | âš ï¸ ë³µì¡ | âœ… ì‰¬ì›€ |
| íƒ€ì… ì•ˆì •ì„± | âŒ ì—†ìŒ | âœ… ì™„ë²½ |
| ë¬¸ì„œí™” | âš ï¸ ë¶€ì¡± | âœ… ê³µì‹ ë¬¸ì„œ |
| ì›¹ ì§€ì› | âœ… ì§€ì› | âœ… ì§€ì› |

**ê²°ë¡ **: **ì¹´ì¹´ì˜¤ ê³µì‹ Flutter SDK ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤!**

---

## ğŸ¯ êµ¬í˜„ ì „ëµ (Flutter Web)

Flutter Webì—ì„œëŠ” **ë¦¬ë‹¤ì´ë ‰íŠ¸ ë°©ì‹**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

### í”Œë¡œìš°
```
1. ì‚¬ìš©ìê°€ "ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸" ë²„íŠ¼ í´ë¦­
    â†“
2. Flutter SDKê°€ ì¹´ì¹´ì˜¤ ì¸ì¦ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    â†“
3. ì‚¬ìš©ìê°€ ì¹´ì¹´ì˜¤ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ + ë™ì˜
    â†“
4. ì¹´ì¹´ì˜¤ê°€ Redirect URIë¡œ ì¸ê°€ ì½”ë“œ ì „ë‹¬
    â†“
5. ë°±ì—”ë“œê°€ ì¸ê°€ ì½”ë“œë¡œ í† í° ìš”ì²­ (REST API)
    â†“
6. ë°±ì—”ë“œê°€ JWT í† í° ë°œê¸‰
    â†“
7. í”„ë¡ íŠ¸ì—”ë“œë¡œ JWT í† í° ì „ë‹¬
    â†“
8. ë¡œê·¸ì¸ ì™„ë£Œ!
```

---

## ğŸ“¦ 1ë‹¨ê³„: íŒ¨í‚¤ì§€ ì„¤ì¹˜

### pubspec.yaml ìˆ˜ì •

```yaml
dependencies:
  flutter:
    sdk: flutter
  
  # ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ SDK
  kakao_flutter_sdk: ^1.9.5  # ìµœì‹  ë²„ì „ í™•ì¸
  
  # ê¸°ì¡´ íŒ¨í‚¤ì§€ë“¤
  provider: ^6.1.1
  dio: ^5.4.0
  shared_preferences: ^2.2.2
```

### íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
flutter pub get
```

---

## ğŸ”§ 2ë‹¨ê³„: ì¹´ì¹´ì˜¤ ê°œë°œì ì•± ì„¤ì •

### 1. ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡

1. [Kakao Developers](https://developers.kakao.com/) ì ‘ì†
2. "ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜" â†’ "ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€í•˜ê¸°"
3. ì•± ì´ë¦„: `ì˜¨ê¸°` ì…ë ¥

### 2. ì•± í‚¤ í™•ì¸

ì•± ì„¤ì • â†’ ìš”ì•½ ì •ë³´:
- **Native ì•± í‚¤**: ë³µì‚¬ (ì˜ˆ: `a1b2c3d4e5f6g7h8i9j0`)
- **REST API í‚¤**: ë°±ì—”ë“œì—ì„œ ì‚¬ìš©

### 3. í”Œë«í¼ ë“±ë¡

ì•± ì„¤ì • â†’ í”Œë«í¼ â†’ Web í”Œë«í¼ ë“±ë¡:
```
http://localhost:8080
https://ongi-front.vercel.app
```

### 4. Redirect URI ì„¤ì •

ì œí’ˆ ì„¤ì • â†’ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ â†’ Redirect URI:
```
http://localhost:8080/auth/kakao/callback
https://ongi-front.vercel.app/auth/kakao/callback
```

### 5. ë™ì˜ í•­ëª© ì„¤ì •

ì œí’ˆ ì„¤ì • â†’ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ â†’ ë™ì˜í•­ëª©:
- âœ… ë‹‰ë„¤ì„ (í•„ìˆ˜)
- âœ… í”„ë¡œí•„ ì‚¬ì§„ (ì„ íƒ)
- âœ… ì¹´ì¹´ì˜¤ê³„ì •(ì´ë©”ì¼) (í•„ìˆ˜)

---

## ğŸŒ 3ë‹¨ê³„: Flutter SDK ì´ˆê¸°í™”

### íŒŒì¼: `lib/main.dart` ìˆ˜ì •

```dart
import 'package:flutter/material.dart';
import 'package:kakao_flutter_sdk/kakao_flutter_sdk.dart';
import 'package:provider/provider.dart';
import 'core/app_theme.dart';
import 'viewmodels/auth_viewmodel.dart';
import 'viewmodels/personality_test_viewmodel.dart';

void main() {
  // ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™” (ì•± ì‹œì‘ ì‹œ ìµœì´ˆ 1íšŒ)
  KakaoSdk.init(
    nativeAppKey: 'YOUR_NATIVE_APP_KEY',  // â† ë„¤ì´í‹°ë¸Œ ì•± í‚¤ ì…ë ¥
    javaScriptAppKey: 'YOUR_JAVASCRIPT_KEY',  // â† JavaScript í‚¤ ì…ë ¥ (ì›¹ìš©)
  );
  
  runApp(const OngiApp());
}

class OngiApp extends StatelessWidget {
  const OngiApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MultiProvider(
      providers: [
        ChangeNotifierProvider(create: (_) => PersonalityTestViewModel()),
        ChangeNotifierProvider(create: (_) => AuthViewModel()),
      ],
      child: MaterialApp(
        title: 'ì˜¨ê¸°',
        theme: AppTheme.lightTheme,
        home: const WelcomePage(),
        debugShowCheckedModeBanner: false,
      ),
    );
  }
}
```

**âš ï¸ ë³´ì•ˆ**: ì‹¤ì œë¡œëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬:
```dart
KakaoSdk.init(
  nativeAppKey: const String.fromEnvironment('KAKAO_NATIVE_KEY'),
  javaScriptAppKey: const String.fromEnvironment('KAKAO_JS_KEY'),
);
```

---

## ğŸ’» 4ë‹¨ê³„: ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ êµ¬í˜„

### íŒŒì¼: `lib/services/kakao_auth_service.dart` [NEW]

```dart
import 'package:kakao_flutter_sdk/kakao_flutter_sdk.dart';

class KakaoAuthService {
  /// ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ (ì›¹ìš©: ë¦¬ë‹¤ì´ë ‰íŠ¸ ë°©ì‹)
  /// 
  /// ì›¹ í™˜ê²½ì—ì„œëŠ” authorizeWithKakaoAccount()ë¥¼ ì‚¬ìš©í•˜ì—¬
  /// ì¹´ì¹´ì˜¤ê³„ì • ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•©ë‹ˆë‹¤.
  Future<String?> loginForWeb({required String redirectUri}) async {
    try {
      // ì›¹ì—ì„œëŠ” isKakaoTalkInstalled()ê°€ í•­ìƒ falseë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ
      // ì¹´ì¹´ì˜¤ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
      
      print('ğŸŒ [ì¹´ì¹´ì˜¤ ì›¹ ë¡œê·¸ì¸] Redirect URI: $redirectUri');
      
      // ì¹´ì¹´ì˜¤ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ (ì›¹)
      await AuthCodeClient.instance.authorize(
        redirectUri: redirectUri,
      );
      
      // ë¦¬ë‹¤ì´ë ‰íŠ¸ í›„ ëŒì•„ì˜¤ë©´ URLì—ì„œ ì¸ê°€ ì½”ë“œ ì¶”ì¶œ
      // (ì‹¤ì œë¡œëŠ” ë°±ì—”ë“œë¡œ ì „ë‹¬)
      return 'ì¸ê°€ì½”ë“œëŠ” Redirect URIì—ì„œ ì¶”ì¶œ';
    } catch (error) {
      print('âŒ ì¹´ì¹´ì˜¤ ì›¹ ë¡œê·¸ì¸ ì‹¤íŒ¨: $error');
      return null;
    }
  }
  
  /// ì¸ê°€ ì½”ë“œ ì²˜ë¦¬ (ì½œë°± í˜ì´ì§€ì—ì„œ í˜¸ì¶œ)
  /// 
  /// Redirect URIë¡œ ëŒì•„ì˜¨ í›„ URLì—ì„œ ì¸ê°€ ì½”ë“œë¥¼ ì¶”ì¶œí•˜ì—¬
  /// ë°±ì—”ë“œë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.
  String? extractAuthCode(String callbackUrl) {
    final uri = Uri.parse(callbackUrl);
    final code = uri.queryParameters['code'];
    final error = uri.queryParameters['error'];
    
    if (error != null) {
      print('âŒ ì¹´ì¹´ì˜¤ ì¸ì¦ ì—ëŸ¬: $error');
      return null;
    }
    
    if (code != null) {
      print('âœ… ì¸ê°€ ì½”ë“œ ë°›ìŒ: $code');
      return code;
    }
    
    return null;
  }
  
  /// ì¹´ì¹´ì˜¤í†¡ ì„¤ì¹˜ ì—¬ë¶€ í™•ì¸
  Future<bool> isKakaoTalkAvailable() async {
    return await isKakaoTalkInstalled();
  }
  
  /// ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ (í† í°ì´ ì´ë¯¸ ìˆëŠ” ê²½ìš°)
  Future<User?> getUserInfo() async {
    try {
      final user = await UserApi.instance.me();
      print('âœ… ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì„±ê³µ');
      print('  - ID: ${user.id}');
      print('  - ë‹‰ë„¤ì„: ${user.kakaoAccount?.profile?.nickname}');
      print('  - ì´ë©”ì¼: ${user.kakaoAccount?.email}');
      return user;
    } catch (error) {
      print('âŒ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨: $error');
      return null;
    }
  }
  
  /// ë¡œê·¸ì•„ì›ƒ
  Future<void> logout() async {
    try {
      await UserApi.instance.logout();
      print('âœ… ì¹´ì¹´ì˜¤ ë¡œê·¸ì•„ì›ƒ ì„±ê³µ');
    } catch (error) {
      print('âŒ ì¹´ì¹´ì˜¤ ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨: $error');
    }
  }
  
  /// ì—°ê²° í•´ì œ (íšŒì› íƒˆí‡´)
  Future<void> unlink() async {
    try {
      await UserApi.instance.unlink();
      print('âœ… ì¹´ì¹´ì˜¤ ì—°ê²° í•´ì œ ì„±ê³µ');
    } catch (error) {
      print('âŒ ì¹´ì¹´ì˜¤ ì—°ê²° í•´ì œ ì‹¤íŒ¨: $error');
    }
  }
}

final kakaoAuthService = KakaoAuthService();
```

---

## ğŸ“„ 5ë‹¨ê³„: ì½œë°± í˜ì´ì§€ êµ¬í˜„

### íŒŒì¼: `lib/views/pages/auth/kakao_callback_page.dart` [NEW]

```dart
import 'package:flutter/material.dart';
import 'package:provider/provider.dart';
import 'dart:html' as html;
import '../../../viewmodels/auth_viewmodel.dart';

class KakaoCallbackPage extends StatefulWidget {
  const KakaoCallbackPage({super.key});

  @override
  State<KakaoCallbackPage> createState() => _KakaoCallbackPageState();
}

class _KakaoCallbackPageState extends State<KakaoCallbackPage> {
  @override
  void initState() {
    super.initState();
    _handleCallback();
  }

  Future<void> _handleCallback() async {
    // í˜„ì¬ URLì—ì„œ ì¸ê°€ ì½”ë“œ ì¶”ì¶œ
    final currentUrl = html.window.location.href;
    final uri = Uri.parse(currentUrl);
    
    final code = uri.queryParameters['code'];
    final error = uri.queryParameters['error'];
    
    if (error != null) {
      // ì—ëŸ¬ ì²˜ë¦¬
      print('âŒ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì—ëŸ¬: $error');
      if (!mounted) return;
      
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹¤íŒ¨: $error')),
      );
      
      Navigator.of(context).pushReplacementNamed('/login');
      return;
    }
    
    if (code == null) {
      // ì¸ê°€ ì½”ë“œ ì—†ìŒ
      print('âŒ ì¸ê°€ ì½”ë“œ ì—†ìŒ');
      if (!mounted) return;
      Navigator.of(context).pushReplacementNamed('/login');
      return;
    }
    
    // ì¸ê°€ ì½”ë“œë¥¼ ë°±ì—”ë“œë¡œ ì „ë‹¬
    print('âœ… ì¸ê°€ ì½”ë“œ ë°›ìŒ: $code');
    
    if (!mounted) return;
    final authViewModel = Provider.of<AuthViewModel>(context, listen: false);
    
    try {
      // ë°±ì—”ë“œë¡œ ì¸ê°€ ì½”ë“œ ì „ë‹¬í•˜ì—¬ JWT í† í° ë°›ê¸°
      await authViewModel.loginWithKakaoAuthCode(code);
      
      if (!mounted) return;
      
      // ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í”„ë¡œí•„ ì„¤ì • í˜ì´ì§€ë¡œ ì´ë™
      if (authViewModel.error == null) {
        Navigator.of(context).pushReplacementNamed('/profile/setup');
      } else {
        // ë¡œê·¸ì¸ ì‹¤íŒ¨
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text(authViewModel.error!)),
        );
        Navigator.of(context).pushReplacementNamed('/login');
      }
    } catch (e) {
      print('âŒ ë°±ì—”ë“œ ì¸ì¦ ì‹¤íŒ¨: $e');
      if (!mounted) return;
      
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text('ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤')),
      );
      Navigator.of(context).pushReplacementNamed('/login');
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: const [
            CircularProgressIndicator(),
            SizedBox(height: 16),
            Text('ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘...'),
          ],
        ),
      ),
    );
  }
}
```

---

## ğŸ” 6ë‹¨ê³„: ë°±ì—”ë“œ API ì—°ë™

### íŒŒì¼: `lib/viewmodels/auth_viewmodel.dart` [ìˆ˜ì •]

```dart
import 'package:flutter/foundation.dart';
import 'dart:html' as html;
import '../models/entities/user_model.dart';
import '../services/kakao_auth_service.dart';
import '../models/api/auth_api.dart';
import '../models/services/storage_service.dart';

class AuthViewModel extends ChangeNotifier {
  User? _currentUser;
  bool _isLoggedIn = false;
  bool _isLoading = false;
  String? _error;
  
  // Getters
  User? get currentUser => _currentUser;
  bool get isLoggedIn => _isLoggedIn;
  bool get isLoading => _isLoading;
  String? get error => _error;
  
  /// ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œì‘ (ì›¹)
  /// 
  /// ì¹´ì¹´ì˜¤ ì¸ì¦ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•©ë‹ˆë‹¤.
  Future<void> startKakaoLogin() async {
    _setLoading(true);
    _setError(null);
    
    try {
      // Redirect URI ì„¤ì •
      final origin = html.window.location.origin!;
      final redirectUri = '$origin/auth/kakao/callback';
      
      print('ğŸš€ [ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œì‘] Redirect URI: $redirectUri');
      
      // ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
      await kakaoAuthService.loginForWeb(redirectUri: redirectUri);
      
      // ë¦¬ë‹¤ì´ë ‰íŠ¸ë˜ë¯€ë¡œ ì´ ì•„ë˜ ì½”ë“œëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
    } catch (e) {
      print('âŒ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œì‘ ì‹¤íŒ¨: $e');
      _setError('ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
      _setLoading(false);
    }
  }
  
  /// ì¹´ì¹´ì˜¤ ì¸ê°€ ì½”ë“œë¡œ ë¡œê·¸ì¸
  /// 
  /// ì½œë°± í˜ì´ì§€ì—ì„œ ë°›ì€ ì¸ê°€ ì½”ë“œë¥¼ ë°±ì—”ë“œë¡œ ì „ë‹¬í•˜ì—¬
  /// JWT í† í°ì„ ë°›ìŠµë‹ˆë‹¤.
  Future<void> loginWithKakaoAuthCode(String authCode) async {
    _setLoading(true);
    _setError(null);
    
    try {
      print('ğŸ”‘ [Step 1] ì¸ê°€ ì½”ë“œë¥¼ ë°±ì—”ë“œë¡œ ì „ë‹¬: $authCode');
      
      // ë°±ì—”ë“œë¡œ ì¸ê°€ ì½”ë“œ ì „ë‹¬
      final authResponse = await authApi.loginWithKakaoAuthCode(authCode);
      
      print('âœ… [Step 2] ë°±ì—”ë“œ ì¸ì¦ ì„±ê³µ');
      
      // JWT í† í° ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
      await StorageService.saveTokens(
        authResponse.accessToken,
        authResponse.refreshToken,
      );
      
      print('âœ… [Step 3] JWT í† í° ì €ì¥ ì™„ë£Œ');
      
      // ì‚¬ìš©ì ì •ë³´ ì„¤ì •
      _currentUser = authResponse.user;
      _isLoggedIn = true;
      
      print('âœ… ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì™„ë£Œ!');
      print('  - ì‚¬ìš©ì ID: ${_currentUser!.id}');
      print('  - ì´ë¦„: ${_currentUser!.name}');
      print('  - ì´ë©”ì¼: ${_currentUser!.email}');
      
      _setLoading(false);
    } catch (e) {
      print('âŒ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹¤íŒ¨: $e');
      _setError(e.toString());
      _setLoading(false);
    }
  }
  
  /// ë¡œê·¸ì•„ì›ƒ
  Future<void> logout() async {
    try {
      // 1. ì¹´ì¹´ì˜¤ ë¡œê·¸ì•„ì›ƒ
      await kakaoAuthService.logout();
      
      // 2. ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì‚­ì œ
      await StorageService.clearAll();
      
      // 3. ìƒíƒœ ì´ˆê¸°í™”
      _currentUser = null;
      _isLoggedIn = false;
      
      notifyListeners();
    } catch (e) {
      print('âŒ ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨: $e');
    }
  }
  
  // Private methods
  void _setLoading(bool value) {
    _isLoading = value;
    notifyListeners();
  }
  
  void _setError(String? value) {
    _error = value;
    notifyListeners();
  }
}
```

### íŒŒì¼: `lib/models/api/auth_api.dart` [ìˆ˜ì •]

```dart
import 'package:dio/dio.dart';
import '../entities/user_model.dart';
import '../entities/auth_response_model.dart';
import 'api_client.dart';

class AuthApi {
  final Dio _dio = apiClient.dio;
  
  /// ì¹´ì¹´ì˜¤ ì¸ê°€ ì½”ë“œë¡œ ë¡œê·¸ì¸
  /// 
  /// ì¹´ì¹´ì˜¤ì—ì„œ ë°›ì€ ì¸ê°€ ì½”ë“œë¥¼ ë°±ì—”ë“œë¡œ ì „ë‹¬í•˜ì—¬
  /// JWT í† í°ì„ ë°›ì•„ì˜µë‹ˆë‹¤.
  Future<AuthResponse> loginWithKakaoAuthCode(String authCode) async {
    try {
      final response = await _dio.post('/auth/kakao', data: {
        'code': authCode,  // ì¸ê°€ ì½”ë“œ ì „ë‹¬
      });
      
      print('âœ… ë°±ì—”ë“œ ì‘ë‹µ: ${response.data}');
      
      return AuthResponse.fromJson(response.data['data']);
    } on DioException catch (e) {
      print('âŒ ë°±ì—”ë“œ ë¡œê·¸ì¸ ì‹¤íŒ¨: ${e.message}');
      if (e.response != null) {
        final errorMsg = e.response!.data['error'] ?? 'ë¡œê·¸ì¸ ì‹¤íŒ¨';
        throw Exception(errorMsg);
      }
      throw Exception('ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”');
    }
  }
  
  /// í† í° ê°±ì‹ 
  Future<AuthResponse> refreshToken(String refreshToken) async {
    try {
      final response = await _dio.post('/auth/refresh', data: {
        'refresh_token': refreshToken,
      });
      
      return AuthResponse.fromJson(response.data['data']);
    } catch (e) {
      throw Exception('í† í° ê°±ì‹  ì‹¤íŒ¨: $e');
    }
  }
}

final authApi = AuthApi();
```

---

## ğŸ¨ 7ë‹¨ê³„: ë¡œê·¸ì¸ ë²„íŠ¼ UI

### íŒŒì¼: `lib/views/widgets/auth/kakao_login_button.dart` [ìˆ˜ì •]

```dart
import 'package:flutter/material.dart';
import 'package:provider/provider.dart';
import '../../../viewmodels/auth_viewmodel.dart';

class KakaoLoginButton extends StatelessWidget {
  const KakaoLoginButton({super.key});

  @override
  Widget build(BuildContext context) {
    return Consumer<AuthViewModel>(
      builder: (context, authViewModel, _) {
        return SizedBox(
          width: double.infinity,
          height: 56,
          child: ElevatedButton(
            onPressed: authViewModel.isLoading
                ? null
                : () async {
                    // ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œì‘ (ë¦¬ë‹¤ì´ë ‰íŠ¸)
                    await authViewModel.startKakaoLogin();
                  },
            style: ElevatedButton.styleFrom(
              backgroundColor: const Color(0xFEE500), // ì¹´ì¹´ì˜¤ ë…¸ë€ìƒ‰
              foregroundColor: Colors.black87,
              elevation: 0,
              shape: RoundedRectangleBorder(
                borderRadius: BorderRadius.circular(12),
              ),
            ),
            child: authViewModel.isLoading
                ? const SizedBox(
                    height: 20,
                    width: 20,
                    child: CircularProgressIndicator(
                      strokeWidth: 2,
                      valueColor: AlwaysStoppedAnimation<Color>(Colors.black87),
                    ),
                  )
                : const Text(
                    'ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ë¡œê·¸ì¸í•˜ê¸°',
                    style: TextStyle(
                      fontSize: 16,
                      fontWeight: FontWeight.w600,
                      color: Colors.black87,
                    ),
                  ),
          ),
        );
      },
    );
  }
}
```

---

## ğŸ—ºï¸ 8ë‹¨ê³„: ë¼ìš°íŒ… ì„¤ì •

### íŒŒì¼: `lib/main.dart` ë¼ìš°íŒ… ì¶”ê°€

```dart
MaterialApp(
  title: 'ì˜¨ê¸°',
  theme: AppTheme.lightTheme,
  initialRoute: '/',
  routes: {
    '/': (context) => const WelcomePage(),
    '/login': (context) => const KakaoLoginPage(),
    '/auth/kakao/callback': (context) => const KakaoCallbackPage(),
    '/profile/setup': (context) => const ProfileSetupPage(),
  },
  debugShowCheckedModeBanner: false,
)
```

---

## ğŸ”§ ë°±ì—”ë“œ API ìš”êµ¬ì‚¬í•­

### POST /api/v1/auth/kakao

**ìš”ì²­:**
```json
{
  "code": "ì¸ê°€_ì½”ë“œ"
}
```

**ë°±ì—”ë“œ ì²˜ë¦¬:**
1. ì¸ê°€ ì½”ë“œë¡œ ì¹´ì¹´ì˜¤ ì„œë²„ì— í† í° ìš”ì²­
2. ì¹´ì¹´ì˜¤ ì•¡ì„¸ìŠ¤ í† í°ìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ
3. ì‚¬ìš©ì ê³„ì • ìƒì„± ë˜ëŠ” ì¡°íšŒ
4. JWT í† í° ë°œê¸‰

**ì‘ë‹µ:**
```json
{
  "success": true,
  "data": {
    "access_token": "JWT_í† í°",
    "refresh_token": "ë¦¬í”„ë ˆì‹œ_í† í°",
    "user": {
      "id": 1,
      "email": "user@kakao.com",
      "name": "í™ê¸¸ë™",
      "profile_image_url": "https://..."
    },
    "is_new_user": true
  }
}
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì‚¬ì „ ì¤€ë¹„
- [ ] ì¹´ì¹´ì˜¤ ê°œë°œì ì•± ë“±ë¡
- [ ] Native ì•± í‚¤, JavaScript í‚¤ ë°œê¸‰
- [ ] Web í”Œë«í¼ ë“±ë¡
- [ ] Redirect URI ì„¤ì •
- [ ] ë™ì˜ í•­ëª© ì„¤ì •

### Flutter í”„ë¡ íŠ¸ì—”ë“œ
- [ ] `kakao_flutter_sdk` íŒ¨í‚¤ì§€ ì„¤ì¹˜
- [ ] `main.dart`ì—ì„œ SDK ì´ˆê¸°í™”
- [ ] `kakao_auth_service.dart` ì‘ì„±
- [ ] `auth_viewmodel.dart` ì‘ì„±
- [ ] `kakao_callback_page.dart` ì‘ì„±
- [ ] `kakao_login_button.dart` ì‘ì„±
- [ ] ë¼ìš°íŒ… ì„¤ì •

### ë°±ì—”ë“œ
- [ ] `/auth/kakao` API êµ¬í˜„
- [ ] ì¸ê°€ ì½”ë“œ â†’ í† í° ë³€í™˜ ë¡œì§
- [ ] ì‚¬ìš©ì ê³„ì • ìƒì„±/ì¡°íšŒ
- [ ] JWT í† í° ë°œê¸‰

---

## ğŸ¯ ê°œì„  ì‚¬í•­ ìš”ì•½

### JavaScript SDK â†’ Flutter SDK

| í•­ëª© | Before (JS SDK) | After (Flutter SDK) |
|------|----------------|---------------------|
| êµ¬í˜„ ë³µì¡ë„ | âš ï¸ ë†’ìŒ (Interop) | âœ… ë‚®ìŒ |
| íƒ€ì… ì•ˆì •ì„± | âŒ ì—†ìŒ | âœ… ì™„ë²½ |
| ìœ ì§€ë³´ìˆ˜ | âš ï¸ ì–´ë ¤ì›€ | âœ… ì‰¬ì›€ |
| ê³µì‹ ì§€ì› | âŒ ì—†ìŒ | âœ… ìˆìŒ |
| ì½”ë“œ ì–‘ | âš ï¸ ë§ìŒ | âœ… ì ìŒ |

### ì£¼ìš” ë³€í™”

1. **JavaScript Interop ì œê±°** - `dart:js` ë¶ˆí•„ìš”
2. **ê³µì‹ SDK ì‚¬ìš©** - `kakao_flutter_sdk` íŒ¨í‚¤ì§€
3. **ë¦¬ë‹¤ì´ë ‰íŠ¸ ë°©ì‹** - ì›¹ í™˜ê²½ì— ìµœì í™”
4. **ì½œë°± í˜ì´ì§€** - ì¸ê°€ ì½”ë“œ ì²˜ë¦¬
5. **íƒ€ì… ì•ˆì •ì„±** - ì»´íŒŒì¼ íƒ€ì„ ì—ëŸ¬ ì²´í¬

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [ì¹´ì¹´ì˜¤ Flutter SDK ê³µì‹ ë¬¸ì„œ](https://developers.kakao.com/docs/latest/ko/kakaologin/flutter)
- [kakao_flutter_sdk íŒ¨í‚¤ì§€](https://pub.dev/packages/kakao_flutter_sdk)
- [ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ê°€ì´ë“œ](https://developers.kakao.com/docs/latest/ko/kakaologin/common)

---

**ì‘ì„±ì¼**: 2025-12-05  
**ë²„ì „**: 2.0 (ê°œì„ íŒ)  
**ìƒíƒœ**: ê³µì‹ SDK ê¸°ë°˜ êµ¬í˜„ ì™„ë£Œ
